# availability matrix

The availability matrix is actually "only" a visualisation of monitoring data. The original matrix has been created in ~ 2006 and has been used since.
There were several reasons which made is really useful. The main reason was to get complete overview of all the testing users on all the servers in simple graph,
which could help easily diagnose problematic servers or realms and could also help diagnose some more complex problems.

[Screenshot](https://github.com/CESNET/eduroam-icinga/blob/master/doc/orig_matrix.png) from original matrix.


## new setup

It was decided that this should be preserved with the new monitoring setup. Original matrix was taken as a model.

The source code is actually in repository [eduroam-monitor](https://github.com/CESNET/eduroam-monitor).
It was not included in this repostiory, because it is not part of the monitoring setup itself, but it is mentioned here in documentation for obvious reasons.

Screenshot from new matrix. - TODO

## how it works

The matrix source data are generated by [generate_matrix.sh](https://github.com/CESNET/eduroam-monitor/blob/master/generate_matrix.sh)
The actual data source is `icingacli` tool. The script uses simple [python script](https://github.com/CESNET/eduroam-monitor/blob/master/sortcsvradius.py) for domain sorting and
`jq` for final transformation into json format. Script execution is setup in a cronjob, so the data are recreated in regular intervals.


The web part is done in d3.js because of previous expirience with it.
Using d3.js made the new matrix loading fast and browers also deal with it well in other aspects.
The web page itself is a statical html page, so everything is done in javascript.
The graph is created by [main.js](https://github.com/CESNET/eduroam-monitor/blob/master/matrix/main.js).
The data are refreshed every 60 seconds.


